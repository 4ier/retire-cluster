<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retire-Cluster Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-network-wired"></i>
                <h1>Retire-Cluster</h1>
            </div>
            <nav class="nav-menu">
                <a href="#dashboard" class="nav-link active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#devices" class="nav-link" data-page="devices">
                    <i class="fas fa-server"></i> Devices
                </a>
                <a href="#tasks" class="nav-link" data-page="tasks">
                    <i class="fas fa-tasks"></i> Tasks
                </a>
                <a href="#settings" class="nav-link" data-page="settings">
                    <i class="fas fa-cog"></i> Settings
                </a>
            </nav>
            <div class="header-actions">
                <button class="btn-icon" id="themeToggle" title="Toggle Theme">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn-icon" id="refreshBtn" title="Refresh">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <div class="connection-status">
                    <span class="status-indicator" id="connectionStatus"></span>
                    <span class="status-text">Connected</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h2>Cluster Overview</h2>
                <div class="page-actions">
                    <button class="btn btn-secondary" onclick="exportData()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-server"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Total Devices</h3>
                        <p class="stat-value" id="totalDevices">0</p>
                        <span class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> <span id="devicesChange">0</span> today
                        </span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Active Tasks</h3>
                        <p class="stat-value" id="activeTasks">0</p>
                        <span class="stat-change">
                            <span id="tasksCompleted">0</span> completed
                        </span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="stat-content">
                        <h3>CPU Cores</h3>
                        <p class="stat-value" id="totalCores">0</p>
                        <span class="stat-change">
                            <span id="coreUtilization">0</span>% utilized
                        </span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="stat-content">
                        <h3>Health Score</h3>
                        <p class="stat-value" id="healthScore">100%</p>
                        <span class="stat-change positive">
                            <i class="fas fa-check-circle"></i> Healthy
                        </span>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Task Execution Trend</h3>
                        <select class="chart-filter">
                            <option>Last 24 Hours</option>
                            <option>Last 7 Days</option>
                            <option>Last 30 Days</option>
                        </select>
                    </div>
                    <div class="chart-body">
                        <canvas id="taskChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Device Distribution</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="deviceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="activity-card">
                <div class="activity-header">
                    <h3>Recent Activity</h3>
                    <button class="btn-text">View All</button>
                </div>
                <div class="activity-list" id="activityList">
                    <!-- Activity items will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Devices Page -->
        <div id="devices" class="page">
            <div class="page-header">
                <h2>Device Management</h2>
                <div class="page-actions">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="deviceSearch" placeholder="Search devices...">
                    </div>
                    <select id="deviceFilter" class="filter-select">
                        <option value="all">All Devices</option>
                        <option value="online">Online</option>
                        <option value="offline">Offline</option>
                    </select>
                    <button class="btn btn-primary" onclick="showAddDeviceModal()">
                        <i class="fas fa-plus"></i> Add Device
                    </button>
                </div>
            </div>

            <div class="devices-grid" id="devicesGrid">
                <!-- Device cards will be inserted here -->
            </div>
        </div>

        <!-- Tasks Page -->
        <div id="tasks" class="page">
            <div class="page-header">
                <h2>Task Management</h2>
                <div class="page-actions">
                    <select id="taskFilter" class="filter-select">
                        <option value="all">All Tasks</option>
                        <option value="running">Running</option>
                        <option value="queued">Queued</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                    <button class="btn btn-primary" onclick="showSubmitTaskModal()">
                        <i class="fas fa-plus"></i> Submit Task
                    </button>
                </div>
            </div>

            <div class="tasks-table-container">
                <table class="data-table" id="tasksTable">
                    <thead>
                        <tr>
                            <th>Task ID</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Priority</th>
                            <th>Device</th>
                            <th>Created</th>
                            <th>Duration</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tasksTableBody">
                        <!-- Task rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings" class="page">
            <div class="page-header">
                <h2>Settings</h2>
            </div>

            <div class="settings-grid">
                <div class="settings-section">
                    <h3>API Configuration</h3>
                    <div class="settings-form">
                        <div class="form-group">
                            <label>API Server URL</label>
                            <input type="text" id="apiUrl" value="http://localhost:8081" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>API Key (Optional)</label>
                            <input type="password" id="apiKey" placeholder="Enter API key if required" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Refresh Interval (seconds)</label>
                            <input type="number" id="refreshInterval" value="5" min="1" max="60" class="form-control">
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Display Preferences</h3>
                    <div class="settings-form">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableNotifications"> Enable Notifications
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableSound"> Enable Sound Alerts
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="autoRefresh" checked> Auto Refresh Data
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Theme</label>
                            <select id="themeSelect" class="form-control">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="auto">Auto (System)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>About</h3>
                    <div class="about-info">
                        <p><strong>Retire-Cluster Dashboard</strong></p>
                        <p>Version: 1.1.0</p>
                        <p>API Version: <span id="apiVersion">Loading...</span></p>
                        <p>
                            <a href="https://github.com/4ier/retire-cluster" target="_blank">
                                <i class="fab fa-github"></i> GitHub Repository
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <!-- Submit Task Modal -->
    <div id="submitTaskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Submit New Task</h3>
                <button class="modal-close" onclick="closeModal('submitTaskModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="submitTaskForm">
                    <div class="form-group">
                        <label>Task Type</label>
                        <select id="taskType" class="form-control" required>
                            <option value="echo">Echo</option>
                            <option value="sleep">Sleep</option>
                            <option value="system_info">System Info</option>
                            <option value="python_eval">Python Eval</option>
                            <option value="http_request">HTTP Request</option>
                            <option value="command">Command</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Priority</label>
                        <select id="taskPriority" class="form-control">
                            <option value="low">Low</option>
                            <option value="normal" selected>Normal</option>
                            <option value="high">High</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Payload (JSON)</label>
                        <textarea id="taskPayload" class="form-control" rows="4" required>{"message": "Hello World"}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Requirements (Optional)</label>
                        <div class="requirements-grid">
                            <input type="number" id="minCpu" placeholder="Min CPU cores" class="form-control">
                            <input type="number" id="minMemory" placeholder="Min Memory (GB)" class="form-control">
                            <select id="requiredPlatform" class="form-control">
                                <option value="">Any Platform</option>
                                <option value="linux">Linux</option>
                                <option value="windows">Windows</option>
                                <option value="darwin">macOS</option>
                                <option value="android">Android</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('submitTaskModal')">Cancel</button>
                <button class="btn btn-primary" onclick="submitTask()">Submit Task</button>
            </div>
        </div>
    </div>

    <!-- Device Details Modal -->
    <div id="deviceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Device Details</h3>
                <button class="modal-close" onclick="closeModal('deviceModal')">&times;</button>
            </div>
            <div class="modal-body" id="deviceDetails">
                <!-- Device details will be inserted here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="removeDevice()">Remove Device</button>
                <button class="btn btn-secondary" onclick="closeModal('deviceModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="toast">
        <div class="toast-content">
            <i class="toast-icon fas fa-info-circle"></i>
            <span class="toast-message"></span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/js/config.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/dashboard.js"></script>
    <script src="/static/js/devices.js"></script>
    <script src="/static/js/tasks.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>